<!DOCTYPE html>
<html>
  <head>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="js/react.js"></script>
    <script src="js/JSXTransformer.js"></script>
    <style type="text/css">
      label.disabled {
        color: #ccc;
      }
      div#body {
        width: 500px;
        margin-left: auto;
        margin-right: auto;
      }
      div#form {
        border: 1px solid #ccc;
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
      }
      h1 {
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div id="body">
      <img src="http://techliminal.com/wp-content/themes/techliminal/assets/img/logo-web.png" />
      <div id="form"></div>
    </div>
    <script type="text/jsx">
      /** @jsx React.DOM */
      var emailValidator = /^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i;
      
      var SigninForm = React.createClass({
        getInitialState: function() {
          return { nameValue: "", emailValue: "" };
        },

        postToMailchimp: function() {
          
        },
        
        updateForm: function() {
          
        },

        handleSignin: function(event) {
          alert("Sign in from "+this.state.nameValue+" <"+this.state.emailValue+">");
          return false;
        },

        handleNameChange: function(event) {
          this.setState({ nameValue: event.target.value });
        },
        handleEmailChange: function(event) {
          this.setState({ emailValue: event.target.value });
        },
        
        render: function() {
          var validEmail = emailValidator.test(this.state.emailValue);
          var labelClass = validEmail ? "" : "disabled";
          var hasName = this.state.nameValue.length > 0;
          
          return <form onSubmit={this.handleSignin} onChange={this.onChange}>
            <h1>Welcome! Sign in:</h1>
            Name: <input onChange={this.handleNameChange} type="text" value={this.state.nameValue} /><br />
            Email: <input onChange={this.handleEmailChange} type="text" value={this.state.emailValue} /><br />
            <label className={labelClass}><input type="checkbox" ref="mailinglist" disabled={! validEmail } checked={this.state.mailinglistValue} /> Yes, please sign me up for updates from Tech Liminal!</label><br />
            <input type="submit" value="Sign in!" disabled={! hasName} />
          </form>;
        }
      })
      React.renderComponent(
        <SigninForm />,
        document.getElementById('form')
      );
    </script>
  </body>
</html>
